# Example config for temporal split strategy
#
# Temporal splitting uses all regions as targets but divides data by date ranges.
# This is useful for evaluating temporal generalization rather than spatial.
#
# Splits are defined as:
# - Train: [start, train_end_date)
# - Val:   [train_end_date, val_end_date)
# - Test:  [val_end_date, test_end_date) or end of dataset if test_end_date is omitted

data:
  # Use valid_targets mask from dataset to filter target nodes
  use_valid_targets: true
  dataset_path: data/processed/synthetic_full.zarr
  region2vec_path: configs/outputs/region_embeddings/region_embeddings.pt
  mobility_threshold: 10
  window_stride: 1
  missing_permit: 4
  sample_ordering: "time"
  log_scale: true
  run_id: "0_Baseline"  # Synthetic run to use for training

model:
  type:
    cases: true
    regions: true
    biomarkers: true
    mobility: true
  params:
    mobility_embedding_dim: 16
    region_embedding_dim: 64
    gnn_module: "gcn"
    #-- seq sizes --#
    history_length: 21
    forecast_horizon: 7
    #-- graph params --#
    max_neighbors: 20
    gnn_depth: 2

output:
  experiment_name: local_temporal
  log_dir: outputs/training

training:
  device: "cpu"
  batch_size: 32
  early_stopping_patience: 5
  nan_loss_patience: 5
  # max_batches: 20
  epochs: 5
  learning_rate: 0.001
  weight_decay: 1.0e-05
  num_workers: 4
  val_workers: 2

  # Temporal split configuration
  split_strategy: "time"
  train_end_date: "2020-04-01"
  val_end_date: "2020-05-01"
  # test_end_date omitted - uses all remaining data

  # Note: val_split and test_split are ignored when split_strategy="time"
  val_split: 0.2
  test_split: 0.1

  profiler:
    enabled: false
    profile_batches: 10
    log_dir: auto
  plot_forecasts: true
  num_forecast_samples: 3
